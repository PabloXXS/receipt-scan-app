# Cursor Rules –¥–ª—è Ticket App

## –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞
- –í–°–ï–ì–î–ê —Å—Å—ã–ª–∞–π—Å—è –Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –≤ –ø–∞–ø–∫–µ `docs/` –ø—Ä–∏ –ø—Ä–∏–Ω—è—Ç–∏–∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏–π
- –ü—Ä–æ–≤–µ—Ä—è–π –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –≤ `docs/data_model.md` –ø–µ—Ä–µ–¥ —Ä–∞–±–æ—Ç–æ–π —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö
- –°–ª–µ–¥—É–π –ø–∞–π–ø–ª–∞–π–Ω—É –∏–∑ `docs/ai_pipeline.md` –ø—Ä–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ OCR/LLM —Ñ—É–Ω–∫—Ü–∏–π
- –ò—Å–ø–æ–ª—å–∑—É–π API –∫–æ–Ω—Ç—Ä–∞–∫—Ç—ã –∏–∑ `docs/api.md` –¥–ª—è —Å–µ—Ä–≤–µ—Ä–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π
- –°–æ–±–ª—é–¥–∞–π –ø—Ä–∏–Ω—Ü–∏–ø—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏–∑ `docs/security.md`
- –ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã - –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –æ–±–Ω–æ–≤–ª—è–π —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ —Ñ–∞–π–ª—ã –≤ `docs/`

## –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫ (—Å–º. docs/architecture.md)
- Flutter 3.22+, Dart 3.4+, Riverpod, Freezed, GoRouter
- Supabase (Auth, Postgres, Storage, Edge Functions)
- –ú—É–ª—å—Ç–∏—è–∑—ã—á–Ω–æ—Å—Ç—å —á–µ—Ä–µ–∑ gen-l10n
- Sentry –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –æ—à–∏–±–æ–∫

## –ú–æ–¥–µ–ª—å –¥–∞–Ω–Ω—ã—Ö (—Å–º. docs/data_model.md)
- –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è: `created_at`, `updated_at`, `is_deleted`
- RLS –ø–æ–ª–∏—Ç–∏–∫–∏ –¥–ª—è –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö —Ç–∞–±–ª–∏—Ü
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å UUID –∫–∞–∫ primary keys
- –°–ª–µ–¥–æ–≤–∞—Ç—å —Å—Ö–µ–º–µ —Ç–∞–±–ª–∏—Ü `receipts`, `receipt_items`, `merchants`, etc.

## –°—Ç–∏–ª—å –∫–æ–¥–∞
- –ü—Ä–∏–º–µ–Ω—è–π –ø—Ä–∞–≤–∏–ª–∞ –∏–∑ `always_applied_workspace_rules` –∏ `user_rules`
- –ò—Å–ø–æ–ª—å–∑—É–π `@riverpod` –∞–Ω–Ω–æ—Ç–∞—Ü–∏–∏, –∏–∑–±–µ–≥–∞–π StateProvider
- ConsumerWidget/HookConsumerWidget –¥–ª—è –≤–∏–¥–∂–µ—Ç–æ–≤
- Immutable –º–æ–¥–µ–ª–∏ —á–µ—Ä–µ–∑ Freezed
- –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ `dart format` –∏ —Å–æ–±–ª—é–¥–µ–Ω–∏–µ `flutter_lints`

## –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ —Ñ—É–Ω–∫—Ü–∏–π
- –ü—Ä–æ–≤–µ—Ä—è–π —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ–¥ –≤ `lib/` –ø–µ—Ä–µ–¥ —Å–æ–∑–¥–∞–Ω–∏–µ–º –Ω–æ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤
- –ù–æ–≤—ã–µ —ç–∫—Ä–∞–Ω—ã –¥–æ–±–∞–≤–ª—è–π –≤ `lib/pages/`, –≤–∏–¥–∂–µ—Ç—ã –≤ `lib/widgets/`
- –°–æ–∑–¥–∞–≤–∞–π –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã –≤ `lib/providers/`, –º–æ–¥–µ–ª–∏ –≤ `lib/models/`
- –°–ª–µ–¥—É–π –Ω–∞–≤–∏–≥–∞—Ü–∏–æ–Ω–Ω–æ–π —Å—Ö–µ–º–µ: Home, Search, Profile, ReceiptDetails, Scan

## Supabase –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
- –ò—Å–ø–æ–ª—å–∑—É–π RLS –ø–æ–ª–∏—Ç–∏–∫–∏ –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö
- –•—Ä–∞–Ω–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ –ø—Ä–∏–≤–∞—Ç–Ω—ã—Ö –±–∞–∫–µ—Ç–∞—Ö —Å –ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–º–∏ URL
- Edge Functions –¥–ª—è —Å–µ—Ä–≤–µ—Ä–Ω–æ–π –ª–æ–≥–∏–∫–∏ OCR/LLM
- –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è: email magic link, Google, Apple OAuth

## –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–π –∏ –æ—à–∏–±–æ–∫
- AsyncValue –¥–ª—è –≤—Å–µ—Ö –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- SelectableText.rich –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –æ—à–∏–±–æ–∫ (–Ω–µ SnackBar)
- Graceful degradation –ø—Ä–∏ —Å–µ—Ç–µ–≤—ã—Ö –æ—à–∏–±–∫–∞—Ö
- Offline-first –ø–æ–¥—Ö–æ–¥ —Å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–µ–π

## –õ–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è –∏ UX
- gen-l10n –¥–ª—è –º—É–ª—å—Ç–∏—è–∑—ã—á–Ω–æ—Å—Ç–∏
- ResponsiveBuilder –¥–ª—è –∞–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç–∏
- –¢–µ–º–Ω–∞—è/—Å–≤–µ—Ç–ª–∞—è —Ç–µ–º—ã
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ RTL —è–∑—ã–∫–æ–≤

## –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- ListView.builder –¥–ª—è —Å–ø–∏—Å–∫–æ–≤
- const –≤–∏–¥–∂–µ—Ç—ã –≥–¥–µ –≤–æ–∑–º–æ–∂–Ω–æ
- cached_network_image –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- Lazy loading –¥–∞–Ω–Ω—ã—Ö

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –∫–∞—á–µ—Å—Ç–≤–æ
- Unit —Ç–µ—Å—Ç—ã –¥–ª—è –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤ –∏ –º–æ–¥–µ–ª–µ–π
- Widget —Ç–µ—Å—Ç—ã –¥–ª—è UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- Golden —Ç–µ—Å—Ç—ã –¥–ª—è –≤–∏–∑—É–∞–ª—å–Ω–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏
- Mock –¥–∞–Ω–Ω—ã–µ –¥–ª—è OCR/LLM –≤ —Ç–µ—Å—Ç–∞—Ö

## –ü–∞—Ç—Ç–µ—Ä–Ω—ã –∏–º–µ–Ω–æ–≤–∞–Ω–∏—è
- –§–∞–π–ª—ã: snake_case
- –ö–ª–∞—Å—Å—ã: PascalCase
- –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ: camelCase
- –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã: SCREAMING_SNAKE_CASE
- –ü—Ä–æ–≤–∞–π–¥–µ—Ä—ã: xxxProvider (userProvider, receiptProvider)

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
```
lib/
‚îú‚îÄ‚îÄ core/           # –û–±—â–∏–µ —É—Ç–∏–ª–∏—Ç—ã, –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã
‚îú‚îÄ‚îÄ models/         # Freezed –º–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö
‚îú‚îÄ‚îÄ providers/      # Riverpod –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã
‚îú‚îÄ‚îÄ repositories/   # Supabase —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏
‚îú‚îÄ‚îÄ pages/          # –û—Å–Ω–æ–≤–Ω—ã–µ —ç–∫—Ä–∞–Ω—ã
‚îú‚îÄ‚îÄ widgets/        # –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –≤–∏–¥–∂–µ—Ç—ã
‚îú‚îÄ‚îÄ l10n/          # –õ–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è
‚îî‚îÄ‚îÄ main.dart
```

## –°–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞ –¥–ª—è TicketApp
- OCR —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –∫–∞–∫ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
- –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —á–µ–∫–æ–≤ —Å–∂–∏–º–∞—Ç—å –Ω–æ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –≤ —á–∏—Ç–∞–µ–º–æ–º –∫–∞—á–µ—Å—Ç–≤–µ
- –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ç–æ–≤–∞—Ä–æ–≤ –∑–∞–≥—Ä—É–∂–∞—Ç—å –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ —Å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º
- –°—Ç–∞—Ç—É—Å –æ–±—Ä–∞–±–æ—Ç–∫–∏ —á–µ–∫–∞ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- –ü–æ–¥–ø–∏—Å–æ—á–Ω–∞—è –º–æ–¥–µ–ª—å: –±–∞–∑–æ–≤—ã–π –∞–Ω–∞–ª–∏–∑ –±–µ—Å–ø–ª–∞—Ç–Ω–æ, —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ –ø–ª–∞—Ç–Ω–æ

## Git workflow –∏ –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
- Conventional commits: `feat:`, `fix:`, `docs:`, `refactor:`, etc.
- Feature branches: `feature/receipt-scanning`, `fix/camera-permission`
- Merge requests —Å –ª–∏–Ω–∫–æ–º –Ω–∞ issue
- Changelog –≤–µ–¥–µ–º –≤ `CHANGELOG.md`

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç—å
- –ù–∏–∫–æ–≥–¥–∞ –Ω–µ –ª–æ–≥–∏—Ä—É–π –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (–¥–∞–Ω–Ω—ã–µ —á–µ–∫–æ–≤, email)
- API –∫–ª—é—á–∏ —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ environment variables
- –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —á–µ–∫–æ–≤ —É–¥–∞–ª—è—Ç—å –ø–æ—Å–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ (–µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ —Å–æ—Ö—Ä–∞–Ω–∏–ª)
- GDPR compliance: –ø—Ä–∞–≤–æ –Ω–∞ —É–¥–∞–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –æ—Ç–ª–∞–¥–∫–∞
- Sentry –¥–ª—è production –æ—à–∏–±–æ–∫
- Performance monitoring –¥–ª—è OCR –æ–ø–µ—Ä–∞—Ü–∏–π
- Analytics —Å–æ–±—ã—Ç–∏—è: scan_started, scan_completed, scan_failed
- Debug —Ä–µ–∂–∏–º —Å –¥–µ—Ç–∞–ª—å–Ω—ã–º–∏ –ª–æ–≥–∞–º–∏ OCR –ø—Ä–æ—Ü–µ—Å—Å–∞

## –®–∞–±–ª–æ–Ω—ã –∫–æ–¥–∞

### –ù–æ–≤—ã–π —ç–∫—Ä–∞–Ω
```dart
@RoutePage()
class ExamplePage extends ConsumerWidget {
  const ExamplePage({super.key});

  @override
  Widget build(BuildContext context, WidgetRef ref) {
    final state = ref.watch(exampleProvider);
    
    return Scaffold(
      appBar: AppBar(title: Text(context.l10n.exampleTitle)),
      body: state.when(
        data: (data) => _buildContent(data),
        loading: () => const Center(child: CircularProgressIndicator()),
        error: (error, stackTrace) => _buildError(error),
      ),
    );
  }
}
```

### –ù–æ–≤—ã–π –ø—Ä–æ–≤–∞–π–¥–µ—Ä
```dart
@riverpod
class Example extends _$Example {
  @override
  FutureOr<List<ExampleModel>> build() async {
    return ref.read(exampleRepositoryProvider).getAll();
  }

  Future<void> addExample(ExampleModel example) async {
    state = const AsyncValue.loading();
    state = await AsyncValue.guard(() async {
      await ref.read(exampleRepositoryProvider).add(example);
      return ref.read(exampleRepositoryProvider).getAll();
    });
  }
}
```

### –ù–æ–≤–∞—è –º–æ–¥–µ–ª—å
```dart
@freezed
class ExampleModel with _$ExampleModel {
  const factory ExampleModel({
    required String id,
    required String name,
    required DateTime createdAt,
    required DateTime updatedAt,
    @Default(false) bool isDeleted,
  }) = _ExampleModel;

  factory ExampleModel.fromJson(Map<String, dynamic> json) =>
      _$ExampleModelFromJson(json);
}
```

## Code Review —á–µ–∫-–ª–∏—Å—Ç
- ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –≤ docs/ –∞–∫—Ç—É–∞–ª—å–Ω–∞
- ‚úÖ –ù–æ–≤—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ–±–æ—Å–Ω–æ–≤–∞–Ω—ã –∏ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã
- ‚úÖ –¢–µ—Å—Ç—ã –ø–æ–∫—Ä—ã–≤–∞—é—Ç –Ω–æ–≤—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª
- ‚úÖ –õ–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è –¥–æ–±–∞–≤–ª–µ–Ω–∞ –¥–ª—è –Ω–æ–≤—ã—Ö —Å—Ç—Ä–æ–∫
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç
- ‚úÖ RLS –ø–æ–ª–∏—Ç–∏–∫–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –¥–ª—è –Ω–æ–≤—ã—Ö —Ç–∞–±–ª–∏—Ü
- ‚úÖ AsyncValue –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- ‚úÖ const –≤–∏–¥–∂–µ—Ç—ã –≥–¥–µ –≤–æ–∑–º–æ–∂–Ω–æ
- ‚úÖ –°–æ–±–ª—é–¥–µ–Ω—ã –ø—Ä–∏–Ω—Ü–∏–ø—ã GDPR/–ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç–∏

## –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è
- –ü—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –Ω–æ–≤—ã—Ö —Ç–∞–±–ª–∏—Ü - –æ–±–Ω–æ–≤–ª—è–π `docs/sql/0001_init.sql`
- –ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ API - –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É–π `docs/api.md`
- –ü—Ä–∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏—è—Ö - —Å—Å—ã–ª–∞–π—Å—è –Ω–∞ `docs/architecture.md`
- –î–æ–±–∞–≤–ª—è–π –Ω–æ–≤—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –≤ `pubspec.yaml` —Å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏
- –û–±–Ω–æ–≤–ª—è–π –º–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Å—Ö–µ–º—ã –ë–î
- –°–æ–∑–¥–∞–≤–∞–π –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —ç–∫—Ä–∞–Ω–∞/—Ñ–∏—á–∏
- –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä—É–π –Ω–æ–≤—ã–µ Environment Variables –≤ README.md
- –¢–µ—Å—Ç–∏—Ä—É–π –∏–∑–º–µ–Ω–µ–Ω–∏—è: `flutter test` –∏ `flutter analyze`

---
üí° **–ü–æ–º–Ω–∏**: –í—Å–µ–≥–¥–∞ –Ω–∞—á–∏–Ω–∞–π —Å –∏–∑—É—á–µ–Ω–∏—è docs/ –ø–∞–ø–∫–∏ –ø–µ—Ä–µ–¥ –Ω–∞–ø–∏—Å–∞–Ω–∏–µ–º –∫–æ–¥–∞!
